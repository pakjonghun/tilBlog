---
date: 2022-05-24
category: til
---

## 오늘 한 일

- 알고리즘 문제 : 교점 에 별 만들기(푸는중)
- nestjs 중 typeorm 사용법 학습
  - typeorm 의 @expose @exclude 를 사용하면서
  - 계산을 한 새로운 필드를 expose 하려면
  - 계산할 테이블이 모두 조인 되 있어야 한다는 것을 알게됬다.
  - 그리고 queryBuilder을 사용하면 일반 쿼리문 보다 좀 더 편하게 작성 할 수 있다는 것을 알게됬다.

## 어려운점

- 관계를 부여할 때 foreignKey를 만들지 않게 하는 옵션도 있었다.
- 관리자가 상품을 팔려고 업로드 하면 그 상품에 주문이 들어왔을때
- 관리자는 상품을 올리기만 하고 그 주문이 삭제되든 말던 할 수 있는게 없으므로
- 이런 경우 foreignKey 를 만들지 않게 설정 해 주는 것 같았다.
- 또 연결은 필요한데(select 할때는 필요하지만 수정 삭제 할때는 관계가 필요 없는 경우도 사용 하는 것 같았다)
- foreignKey 를 사용 하지 말아야 할때(관계는 있는데 포런키는 없어도 되는 그런관계?)의 아직 정확한 개념을 잘 모르겠다.
- typeorm 에서 일부 relations 옵션과 where 옵션을 축약해서 같이 사용하면 작동 안하는 경우를 발견했다.
- 공식문서 보고 queryBuild 로 바꿔주면서
- sql 을 잘 모르고 있다는 것을 알게되었다. orm만 자꾸 사용하다 보니 sql 이 가물가물하고...
- 그래서 방법을 찾다가 queryBuild 가 sql 문 사용과 유사한 orm 이다보니 queryBuild 위주로 사용 해야겠다는 생각을 했다.
- 그리고 프로그래머에서 sql 문제가 보여서 같이 풀어봤는데 도움이 많이 되었다.
- 앞으로도 계속 sql 문제를 조금씩 풀어봐야 겠다고 생각했다.

## 해야 할 일

- nest 캐슁 기능 redis 같이 사용하는 방법 학습
- sql 문제도 조금씩 풀기
- queryBuild 위주로 orm 작성하기
