---
category: til
date: 2022-03-10
---

## 오늘 한 일

- 배포만 계속 했다.
- https 에서 http api 를 요청하니 오류가 떠서 헤메다가
- netlify 는 무조건 https 라는걸 알게되고,
- aws ec2 로 해서 내 입맛에 맞게 구성하는 것이 좋겠다는 생각에 aws 인프라를 구축하는 공부를 하고 진행했다.
- 서울 리전에 vpc 1개를 만들고 2개 퍼블릭 서브넷을 만들고
- 1개 서브넷에 ec2 를 또 1개 서브넷에 rds 를 넣었다.
- ec2에 프론트와 백을 다 넣고 각각 포트를 다르게 해서 작동하게 하려고 했는데 생각해보니 외부에서 백엔드에 접근할 일이 없어보였다.
- 그래서 백엔드를 넣게된다면(아직은 없음) 프론트에서 백에 localhost 로 접근하면 될것 같았고 포트는 겹치지만 않으면 될것 같았다.
- http접근을 모두 80 포트로 몰아주고
- 80 포트가 자동으로 프론트 포트로 가도록 포트포워딩해주고
- pm2 로 스크립트를 실행하게 하는 방식으로 포트를 맞추었다.
- 만약 서버가 여러개가 된다면 그래서 ec2 를 여러개 파야 한다면
- 그러면 route table 등을 다르게 파야 겠지만 그럴일이 있을까?
- 서버가 여러개 생개서 ec2 를 2개 사용 한다면 나같으면 이메일 하나 더 구해서 aws 계정을 파서 새로 vpc 만들어서 꽁짜로 1년동안 각각 연결해서 사용 할 것 같고.
- 그게 된다면 서로 다른 vpc 로 로드 벨런싱 같은 것이 적용 될런지 궁금하다. vpc 내부에만 route 를 둬야 한다면 아마 힘들 것 같기도 하다.

## 어려운점

- 배포는 리눅스를 잘 해야 잘 할 수 있는 것 같았다.
- 리눅스 명령 vi vim 사용을 잘 못하니 시간이 오래 걸리는 것 같아서 이건 꾸준히 하거나, 아예 기록을 잘 해놓고 바로바로 갖다 복사 하는 방법으로 써야 할 것 같았다.
- rds 를 결국 사용한다면 sql 문은 필요할때만 사용하다 스케일 확장에 유리하다고 배운 orm 을 잘 활용해야겠다는 생각을 했다.

## 해야 할 일

- 고민 할 것 깃에 다시 올리고 다시 클론받고 하는게 너무 귀찮다.(풀이던 클론이던 간에..)
- ci/cd 이거 참 배우고 싶어지긴 하는데 일단
- 도커 레디스 등 더 기본적이고 효과적인 방법을 먼저 익히고
- 진도를 나가는 것이 맞는지
- 프로젝트를 다시 만들고 배포를 반복하는것이 옳은지 이것저것 고민을 해봐야 할 것 같다.
