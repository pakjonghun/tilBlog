---
date: 2022-05-13
category: til
---

## 오늘 한 일

- 알고리즘 : 프로그래머스 프렌즈 4블록 문제 푸는중(진짜 어렵다...)
  - 4칸이 같은 것은 확인했다. 방법을 찾았다.
  - 그 다음으로 진행하려면 체크된 것을 모두 없애고 없앤 후 재정렬 해 주어야 하는데 정말...
    생각이다.
- 영화 찾기 프로젝트
  - 필터 부분은 모두 작성했다.
  - 레코일에서 알려주는 패턴을 이것저것 넣어보면서 가장 적합하다고 생각되는 방법만 넣어주었다.
  - 내친김에 레코일 공식문서에서 알려주는대로 테스트도 진행해 봤다.

## 어려운점

- 알고리즘
  - 시간을 많이 잡아먹는 문제 같다 다른사람 풀이보고 그냥 배끼고 싶은데..
  - 그런 풀이가 있는 명확한 문제가 아닌 것 같았다.
  - 오히려 생각 하다 보니 응용력과 구현력을 기르는데 꽤 도움이 될 것 같아서 끝까지 혼자 풀어볼 생각이다.
- 영화 찾기 프로젝트

  - 컴포넌트가 나뉘지 않는 것은 atomFamiily 로 작성하면 오히려 복잡해 진다.
  - selectorFamily atomFamily 가 타입 정립이 좀 이해가 안된다.
    - 파라미터로 주는 타입과 리턴하는 타입이 같은데 이건.. 너무 딱딱하다 응용하기 어렵다.
    - 다른 곳에서 사용한 코드 보니.. 그냥 any 타입으로 해버리거나 ignore-ts 해버리던데 개선이 필요해 보인다.
  - id로 나눠서 랜더링이 많이 안 일어나게 만들고 싶어서 이리저리 고민을 많이 했다.
  - atomEffect 부분도 써보면서 캐쉬도 만들고,
  - 그런데 effect 는 리턴되는 타입이 loadable promise 라서 atom 내부에서 조작하기가 힘들었다. 타입이 망가진채로 오니.. unstable 은 역시 이유가 있는것 같았다.
  - 테스트

    - 레코일때문에 axios 를 지웠다 테스트 할때 axio 를 모킹해도 비동기 테스트 가 잘 안된다.
    - msw 하고도 연동이 안되는것 같았다.
    - selector 이게 문제 인데, 공식문서에 나온대로 fetch 로 통신 툴을 바꿔서야 제대로 작동이 됬다.
    - axios 없이도 잘 되므로 그냥 지웠다.
    - 비동기 테스트 해결하니 그 다음문제는 selector 테스트 였다.
    - observer 함수가 atom 은 잘 인식하는데
    - selector 는 인식이 안된다.
    - selector 는 react 외부에서 유닛 테스트 하는 방법이 소개 되 있어서 그대로 따라서 테스트를 작성했다.
    - 하지만 constSelector 부분은 역시 테스트가 안된다.
    - snapshot 에 get도 들어가 있으면 좋겠다고 생각했다. get 이 있으면 정말 다 할수 있을텐데..
    - 그 외 에러인지 체크 하는 함수 에러가 무엇인지 확인하는 함수 등등 많은 테스트 기능을 사용 해 보았다. 공식문서에 잘 소개 되 있어서 그대로 따라 하니 잘 작동했다.
    - 테스트 할때 불안한 부분은 userEvent 를 할때 이전에는 이벤트에서 await 해주고 ui 를 확인했는데
    - recoil을 사용 해서 그런지 이렇게 하니까 테스트 시간이 초과되서 오류가 떴다.
    - userEvent 는 그냥 적어주고, ui 찾는 부분에 await 를 해줘서 해결했는데
    - 좀 아쉬웠다....

    ## 해야 할 일

    - 영화 무한스크롤 기능 작성
    - 영화 필터링 기능 연계한 아이템 출력 기능 작성
    - tv 도 동일하게 작성
    - 이때 레코일 을 어떻게 구성할 것인지 고민 할 것
      - 페이지별 atomFamily가 되야 함
      - 각 아톰 페밀리는 페이지를 갖고 통신하는 패밀리 셀렉터로 초기값을 가져야 함
      - 셀렉터이므로 별도 캐쉬 필요 없고 페이지만 잘 유지하면되므로
      - currentPage 라는 아톰으로 현재까지 페이지 유지하면됨.
      - 페이지 번호로 아이템을 그려야 하는데 1페이지당 1~20 아이템 이므로
      - 아이템 length 만 벹어내는 셀렉터를 별도로 가져야함.
    - 정리하면
      1. 현재까지 페이지 번호 저장하는 아톰
      2. 영화 페이지 별 통신결과 저장하는 패밀리 아톰
      3. 통신하는 selector 페밀리도 괜찮고 그냥 셀렉터도 괜찮아 보임
      4. 그냥 셀렉터로 하면 페이지 아톰을 좀더 쉽게 이용 가능 코드가 줄을듯
      5. 통신 후 아톰 패밀리의 length만 반환하는 별도 셀렉터 패밀리(아톰페밀리 아뒤로 접근 해야 하므로)가 필요함.
      6. 와 재미있겠다!! 내일 언능 작업 해보자!!!!!
