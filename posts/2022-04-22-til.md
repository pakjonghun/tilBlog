---
date: 2022-04-22
category: til
---

## 오늘 한 일

- Redux RTK 를 개요를 처음부터 끝까지 다 읽어 보았다.
- RTK 로 간단한 쿼리만 3개 정도 만들어서 사용해 보았다.
- 초과근무 프로젝트 버그 수정하면서 비동기 문제 에 대해서 고민을 해보았다.
- 알고리즘.. 음... 3일째 못풀고 있다.

## 어려운점

- 비동기로 처리 과정중 서버와 클라이언트 동기화가 어려웠다.
- 실제로 타이머 기능에 타이머 상태 : 작동중, 유저상태 : 일하는중, 시작시간 등등 3~4가지 조건의 조합에 따라 각종 오작동이 많이 일어났는데
- 이것을 해결하기 위해서 클라이언트에 중구난방으로 클라이언트 스테이트를 만들었더니
- 더 해결하기 힘들어지고 복잡해졌다.
- 그리고 결국 해결했는데 해결방법은 직접적인 서버와의 동기화 방법이다.
- 결국 서버에 정확한 데이터가 저장되고 불러와 져야 하므로 인터넷 상태나 성능 고려하지 않고, 오로지 서버와 동기화 에만 신경쓰면 스테이트 비동기 사이드이팩트 때문에 고통 받을 일이 많이 줄어든다.
- 그러면서 생각했다. 비동기 처리방법을 글로벌하게 효과적으로 짧은코드로 잘 할 방법이 없을까?
- swr 아니다.. react-query 이것도 아니다. 어처피 글로벌 관리는 해야 하고,
- contextapi 와 커스텀 훅도 너무 시간이 오래걸리고 결국 redux 처럼 만들게 된다.
- 그래서 지금 생각 한 방법은 리덕스 방법인데 리덕스 중에서도 RTK 가 어떤건지 공식문서를 꼼꼼히 읽어 보았다.
- RTK 좋아 보인다 각종 옵션이 캡슐화되어서 제공되는데 프리패치, 캐시조작 같은 것도 그렇게 엄청 어렵지 않고, 태그 를 이용해서 조작 하는 방식도 익숙치는 않았지만 자바스크립트 답다? 함수형 프로그래밍 방식 이라는 느낌을 많이 받았다.
- 그래서 RTK 이용해서 다시 프로젝트를 뜯어 고리쳐고 한다.

## 해야 할 일

- 알고리즘은 하루 30분 정도만 고민하자.
- 일단 모든 통신은 RTK 로 처리 해보자
- 이것저것 나누지 말고 empty slice 하나 만들어서 계속 주입하고, 여기서 캐슁 조작하는 방식으로 하나하나 천천히 만들어보자.
- 스킵, 옵티미스틱UI, preFetch, baseQuery 등등 doc에 나온 것들 참고로 해서 하나하나 적용해 보자
- 프로젝트는 이미 너무 많이 뜯어고치고 다시 고치고 해서 이제 지겹다. ㅋㅋ
- 조금만 더 힘내서 유의미한 결과물을 만들어 보자!!
