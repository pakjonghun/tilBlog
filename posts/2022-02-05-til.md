---
category: til
date: 2022-02-05
---

## 오늘 한일

- uber eats 클론코딩 restaurant module 추가
- 1개 resolve 작성하면서 테스트 코드 작성하면서 진행

## 어려운점

- 비동기가 아닌 메서드를 비동기 처리를 실수로 했는데
- 서버가 죽어버려서 깜짝 놀랐다. 아무거나 비동기 처리하면 안된다는 것을 알게 되었다.
- metaData 를 class 에 주입시켜서 주입된 데이터로 guard 를 하는 방법을 적용했는데
- getHandler 를 해서 원시데이터를 받는 부분은 이해를 했지만
- getClass 는 뭐하는 함수인지 잘 모르겠다.
- 그리고 doc 대로 따라하자면 metadata 를 세팅 할때 Array 형태로 전달해 주던데
- 일일히 [] 하는 것이 보기 안좋아서 "" 형태로 내가 필요한 것만 보내봤는데 작동은 했다.
- 그런데 일전에 doc 대로 안해서 버그가 생겨서 버그 찾는데 고생한것을 생각해서 일단 Array 로 doc 에서 한대로 따라서 했다.
- 확실하게 이해하기 전까지는 doc 대로 하는게 낫다는 생각을 다.
- testcode 를 작성하는데 자꾸 처리가되어야 하는 오류가 떠서 왜 그런가 알아보니
- test module 이 원래 서버와 환경이 다르게 적용되어 있었다.
- useGlobalPipe 같은것들이 적용이 안되있어서 validate 가 작동 안하고 있었던 것이다.
- 테스트 할때는 환경을 똑같이 만들어야 한다는 점을 다시 한번 상기 해보았다.

## 해야할 일

- category 작성할 차례인데 이것은 중복되는 부분이 많아서 따로 모듈로 작성 안하고 진행 해야 할 것 같다.
- dish 부분은 제대로 한다면 Many to Many 로 처리가 되어야 하지만
- typeorm 을 이래저래 써보니 explict 보다는 implict 가 더 편하고 지원 decorator 가 많아서 활용도도 높았다.
- 그래서 manytomany 부분은 nosql 처럼 object나 array 를 db에 넣는 방식을 배워볼까 한다.
- 그러면 typeorma 에서 제공하는 decorator 다 사용하면서 implict 적용하면서 필요한 데이터를 마음대로 커스텀 할 수 있을 것 같다는 생각을 했다.
- 단 이 경우 성능 문제가 발생 할 경우 indexing 같은 것이 적용이 될지는 모르겠다.
